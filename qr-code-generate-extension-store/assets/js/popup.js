var fore_bg,back_bg,img_size,is_transparnet_bg,select_input_type="url";const PHONE_NUMER_PATTERN=/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;function selectInputType(){return $("#select-input-type")}function QRCodeTextElement(){return $("#qrcode-text")}function QRCodeImageElement(){return $("#qrcode-img")}function generateQRCode(e){e=e||selectInputType().val();var t=QRCodeTextElement().val();switch(e){case"url":generateQRCodeByURL(t);break;case"text":generateQRCodeByText(t);break;case"phone":generateQRCodeByPhone(t)}}function generateQRCodeByURL(e){var t=QRCodeImageElement();t.html(""),renderQR(t,img_size,e),QRCodeTextElement().val(e)}function generateQRCodeByText(e){generateQRCodeByURL(e)}function generateQRCodeByPhone(e){generateQRCodeByURL(e)}function saveQRCode(){var e=document.createElement("a");e.href=QRCodeImageElement().find("img")[0].src,e.download="qr_code.png",e.click()}function renderQR(e,t,n){var r="0";"#ffffff"!=back_bg&&(r="1"),is_transparnet_bg&&(back_bg=null),e.qrcode(qrObjectBuilder(t,fore_bg,n,back_bg,r))}function qrObjectBuilder(e,t,n,r,o,a){var c="image";a&&(c="canvas");var d={render:c,size:e,fill:t,text:n,background:r,quiet:o,ecLevel:"L"};return d}$((function(){img_size=300,getCurrentTabUrl().then(e=>{generateQRCodeByURL(e)}),QRCodeTextElement().focus().select(),$("#btn_save_qr").click(()=>saveQRCode())})),QRCodeTextElement().on("input",(function(e){var t=$("#input-error");"phone"===select_input_type&&0==PHONE_NUMER_PATTERN.test(QRCodeTextElement().val())?t.show():t.hide(),generateQRCode()})),selectInputType().change(e=>{$("#input-error").hide(),generateQRCode(select_input_type=e.target.value),QRCodeTextElement().val(""),QRCodeTextElement().focus().select()});